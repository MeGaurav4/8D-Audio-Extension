document.addEventListener("DOMContentLoaded",(function(){const e=document.getElementById("toggle"),t=document.getElementById("editControls"),n=document.getElementById("controls"),o=document.getElementById("intensity"),i=document.getElementById("intensityValue"),s=document.getElementById("rotationSpeed"),c=document.getElementById("rotationSpeedValue"),r=document.getElementById("resetControls"),a=document.getElementById("info-icon"),d=document.getElementById("info-text"),u=1.5,l=.02;function m(t){e.textContent=t?"Disable 8D Audio":"Enable 8D Audio"}function y(e,t){o.value=e,i.textContent=e,s.value=t,c.textContent=t}function g(e,t){chrome.storage.sync.set({intensity:e,rotationSpeed:t})}chrome.tabs.query({active:!0,currentWindow:!0},(function(n){const o=n[0].url;o&&(o.includes("youtube.com")||o.includes("music.youtube.com"))?chrome.tabs.sendMessage(n[0].id,{action:"getState"},(function(t){chrome.runtime.lastError?(console.error("Error:",chrome.runtime.lastError),e.textContent="Error: Refresh the page",e.disabled=!0):(m(t.enabled),chrome.storage.sync.get(["intensity","rotationSpeed"],(function(e){y(e.intensity||u,e.rotationSpeed||l)})))})):(e.textContent="Not available on this page",e.disabled=!0,t.style.display="none")})),e.addEventListener("click",(function(){chrome.tabs.query({active:!0,currentWindow:!0},(function(e){chrome.tabs.sendMessage(e[0].id,{action:"toggle"},(function(e){chrome.runtime.lastError?console.error("Error:",chrome.runtime.lastError):m(e.enabled)}))}))})),t.addEventListener("click",(function(){n.classList.toggle("visible")})),o.addEventListener("input",(function(){const e=parseFloat(this.value);i.textContent=e,g(e,parseFloat(s.value)),chrome.tabs.query({active:!0,currentWindow:!0},(function(t){chrome.tabs.sendMessage(t[0].id,{action:"setIntensity",value:e})}))})),s.addEventListener("input",(function(){const e=parseFloat(this.value);c.textContent=e,g(parseFloat(o.value),e),chrome.tabs.query({active:!0,currentWindow:!0},(function(t){chrome.tabs.sendMessage(t[0].id,{action:"setRotationSpeed",value:e})}))})),r.addEventListener("click",(function(){y(u,l),g(u,l),chrome.tabs.query({active:!0,currentWindow:!0},(function(e){chrome.tabs.sendMessage(e[0].id,{action:"setIntensity",value:u}),chrome.tabs.sendMessage(e[0].id,{action:"setRotationSpeed",value:l})}))})),a.addEventListener("click",(function(){d.style.display="none"===d.style.display?"block":"none"}))}));